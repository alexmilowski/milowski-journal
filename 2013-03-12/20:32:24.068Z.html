<article xmlns="http://www.w3.org/1999/xhtml" vocab="http://schema.org/" typeof="BlogPosting" resource="http://www.milowski.com/journal/entry/2013-03-12T20:32:24.068000+00:00">
<script type="application/ld+json">
{
"@context" : "http://schema.org/",
"@id" : "http://www.milowski.com/journal/entry/2013-03-12T20:32:24.068000+00:00",
"@type" : "BlogPosting",
"genre" : "blog",
"headline" : "What is the Subject Origin?",
"description" : "[RDFa](http://www.w3.org/TR/rdfa-core/) allow annotations of subjects (identifiers) to exist in multiple locations within a document. When a user tries to retrieve elements by this subject identifier, what element is returned? Currently, the [RDFa API](http://www.w3.org/TR/rdfa-api/) says that all the element origins in the document identified via `@about` , `@resource,`   `@src` , `@href` are returned by the  `document.getElementsBySubject()` API method.",
"datePublished" : "2013-03-12T20:32:24.068000+00:00",
"dateModified" : "2013-03-12T20:32:24.068000+00:00",
"keywords" : "RDFa,RDFa API,JavaScript" ,
"author" : [ { "@type" : "Person", "name" : "Alex Miłowski" }],
"publisher" : { "@type" : "Person", "name" : "Alex Miłowski"}
}
</script>
<h1>What is the Subject Origin?</h1>
<p><a href="http://www.w3.org/TR/rdfa-core/">RDFa</a> allow annotations of subjects (identifiers) to exist in multiple locations within a document. When a user tries to retrieve elements by this subject identifier, what element is returned? Currently, the <a href="http://www.w3.org/TR/rdfa-api/">RDFa API</a> says that all the element origins in the document identified via <code>@about</code> , <code>@resource,</code>   <code>@src</code> , <code>@href</code> are returned by the  <code>document.getElementsBySubject()</code> API method.</p>
<p>For example, consider this example using RDFa:</p>
<pre><code>
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&amp;gt;
    &amp;lt;head&amp;gt;
        &amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;
    &amp;lt;/head&amp;gt;
    &amp;lt;body vocab=&quot;http://www.example.com/&quot;&amp;gt;
       &amp;lt;div about=&quot;_:ex1&quot;&amp;gt;
          &amp;lt;span property=&quot;a&quot;&amp;gt;v1&amp;lt;/span&amp;gt;
       &amp;lt;/div&amp;gt;
       &amp;lt;div about=&quot;_:ex1&quot;&amp;gt;
          &amp;lt;span property=&quot;b&quot;&amp;gt;v2&amp;lt;/span&amp;gt;
       &amp;lt;/div&amp;gt;
       &amp;lt;div resource=&quot;_:ex1&quot;&amp;gt;
          &amp;lt;span property=&quot;c&quot;&amp;gt;v3&amp;lt;/span&amp;gt;
       &amp;lt;/div&amp;gt;
       &amp;lt;div about=&quot;_:ex1&quot; typeof=&quot;T&quot;&amp;gt;
          &amp;lt;span property=&quot;d&quot;&amp;gt;v4&amp;lt;/span&amp;gt;
       &amp;lt;/div&amp;gt;
       &amp;lt;div resource=&quot;_:ex1&quot; typeof=&quot;T&quot;&amp;gt;
          &amp;lt;span property=&quot;e&quot;&amp;gt;v5&amp;lt;/span&amp;gt;
       &amp;lt;/div&amp;gt;
    &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;       

</code></pre>
<p>This example generates the triples:</p>
<pre><code>
&amp;lt;origin.xhtml&amp;gt;	&amp;lt;http://www.w3.org/ns/rdfa#usesVocabulary&amp;gt;	&amp;lt;http://www.example.com/&amp;gt;
@prefix e: &amp;lt;http://www.example.com/&amp;gt; .
&amp;lt;_:ex1&amp;gt; rdf:type &amp;lt;http://www.example.com/T&amp;gt; ;
        e:a	&quot;v1&quot; ;
        e:b	&quot;v2&quot; ;
        e:c	&quot;v3&quot; ;
        e:d	&quot;v4&quot; ;
        e:e	&quot;v5&quot; .

</code></pre>
<h3>What is the subject origin?</h3>
<ol>
<li>Five <code>div</code> elements use the subject <code>_:ex1</code> .</li>
<li>Each child <code>span</code> element generates a different property.</li>
<li>Two separate elements type the subject as <code>http://www.example.com/T</code> .</li>
</ol>
<p>With the current <a href="http://www.w3.org/TR/rdfa-api/">RDFa API</a> , all of these div elements should be returned by <code>document.getElementsBySubject(&quot;_:ex1)</code> and two by <code>document.getElementsByType(&quot;http://www.example.com/T&quot;)</code> . Also, each property is generated by a different set of descendants of each subject element origin.</p>
<p>Obviously, this particular example is quite pathological. That said, the ability to have subject annotations in different places within a single document is a good feature that is useful when the content doesn't follow a tree structure. As such, in practice, something like this will happen for good reasons.</p>
<p>In contrast, it probably isn't a good idea to type a subject in different locations.  The resulting annotation graph (i.e. triples) are the same but it just isn't necessary to do as the same thing is being said twice.  Alas, it is possible and is likely to happen in some document somewhere on the Web.</p>
<h3>What does this mean for an easier API?</h3>
<p>There are some hard bits here in that getting subject and typed element origins always needs to return an array of elements.  This means that for simple annotations where there is only one subject/typed element origin, the API has a cardinality mismatch.  I'm not sure what the right answer is but always having to de-reference an array is unfortunate.</p>
<p>Further, if we want to have an RDFa API object accessible on the element origin, as <a href="https://code.google.com/p/green-turtle/">Green Turtle</a> does in a limited way, then this object/element pair needs to have three properties:</p>
<ul>
<li>The element must be the origin of a single subject.</li>
<li>The same RDFa API object must be accessible from all subject origins.</li>
<li>The same subject properties (i.e. subset of the annotation graph) must be available.</li>
</ul>
<p>I believe that (1) is satisfied by the way subjects are generated from the RDFa attributes in <a href="http://www.w3.org/TR/rdfa-core/#s_sequence">section 7.5 of the RDFa 1.1 Core </a> specification.  As such, the same object can be presented via the API to the consumer for that particular subject.  This also helps satisfy (2).</p>
<p>The third part is essentially acknowledging that this object is a  “jumping off point” where a consumer is likely to access any number of properties of the subject.  As such, you should get all the properties regardless of whether they are actually specified on that particular element or its descendants.  That is, from a usability perspective, it doesn't make sense to restrict it to those derived from the descendants.</p>
<p>Further refining this, generating the subset of properties only exhibited by that element is more computationally expensive.  The regular element DOM will tell you the authored properties if you just look at the descendants' use of the RDFa attributes.  As such, authoring tools can determine this in better ways.</p>
<h3>What next?</h3>
<p>My proposal is that every subject origin have a <code>data</code> property that is the RDFa API object.  The <code>id</code> property of this object returns the subject URI.  Further methods on this object should allow access to the subject properties (i.e. subset of the annotation graph).</p>
<p>The next problem is how to make accessing properties and values easier for scripting.</p>
</article>
